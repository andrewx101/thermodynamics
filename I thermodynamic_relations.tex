\documentclass[main.tex]{subfiles}
\begin{document}
\section{热力学的学习建议}\label{I.1 learning_advices}
仅靠在本科阶段的物理化学课堂学习是很难一次性把热力学学透彻的。

首先，想要往后的学习比较顺利，就要求我们对热力学最基础的概念和思想——尤其是引出热力学第一定律之前的准备性概念——拥有十分准确理解。而准确理解这些概念是需要反复地反思、质疑和消化的。最好还能批判地回顾热力学的发展历史，以便理解热力学是如何从历史上的纷繁表象发展到现在的本质认识的。这便更是一个很长的学习过程，也是学习热力学的第一道槛。

学习热力学的第二道槛是把物理上关于系统及其过程的陈述，与数学上的多元函数微积分语言统一起来。大部分同学在本科阶段只学习了一遍高等数学，对多元函数的微积分的理解可能还不准确、不熟练，面对热力学关系中大量出现的微分关系和偏导数关系无法自行验算；哪怕是被动接受（“记公式”），也不知道何时使用、如何使用。

学习热力学的第三道槛就是灵活应用热力学理论去处理科学研究或工业生产中的问题。

我建议同学们分清这三个学习阶段，认识到热力学学习之路的悠远，不必急于一蹴而就。热力学是统领大半个物理学的基本理论，它值得任何一名未来的科技工作者花一生的时间去掌握，因此不必强求学习进度的快慢。以下我将分几个方面介绍一些写得好、易于自学的参考资料。

一、热力学思想和概念（到热力学第二定律为止）

以下章节可供读者在有限时间内，不太发散地集中学习这方面内容：
\begin{itemize}
  \item 王竹溪. 热力学 [M]. 第二版. 高等教育出版社, 1960. 绪论、第一至三章
  \item 韩德刚 高执棣 高盘良. 物理化学 [M]. 第二版. 高等教育出版社, 2008. 第一章
\end{itemize}
以下资料可供本科层次读者细致地了解热力学理论的历史脉络：
\begin{itemize}
  \item Fowler, Michael. Physics 152: Heat and Thermodynamics [EB/OL]. [2024/8/12]. \\https://galileo.phys.virginia.edu/classes/152.mf1i.spring02/HeatIndex.htm.
  \item Müller, I. A History of Thermodynamics[M]. Springer, 2007.
\end{itemize}
以下资料可供读者在初步完整地学习完热力学之后温故而知新：
\begin{itemize}
  \item 王竹溪. 热力学 [M]. 第二版. 高等教育出版社, 1960. 全书
  \item Callen, Herbert B. Thermodynamics and an introduction to thermostatistics [M]. 2nd ed. Wiley, 1985. Part I
  \item Reichl, E L. A Modern Course in Statistical Physics [M]. 2nd ed. University of Texas Press, 1980. Ch.1$\sim$4
\end{itemize}

二、复习高等数学中函数微积分部分的内容，并用这些知识去理解物理化学或热力学课本当中出现的数学式子和推导过程。这部分资料很多，不一一罗列了。建议在数学过关的基础上，亲自推导物理化学或热力学课本上的全部微分和偏导数关系式，最好重复若干次。

三、关于热力学的实践应用，可以参考以“化工热力学”为标题的教材，并重点留意关于处理非理想系统的内容。
\begin{itemize}
  \item Smith, J. M.; Van Ness, H. C.; Abbott, M. M. Introduction to Chemical Engineering Thermodynamics [M]. 9th ed. McGraw Hill, 2022.
\end{itemize}
除了一般的化工热力学教材之外，还可以参阅一些热力学在你关心领域的应用专著。例如溶液热力学：
\begin{itemize}
  \item Van Ness, H. C. Classical Thermodynamics of Non-Electrolyte Solutions [M]. Pergamon Press, 1964.
  \item Van Dijk, M.; Wakker, A. Concepts of Polymer Thermodynamics [M]. ChemTec Publishing, 1997
  \item Klenin, V. J. Thermodynamics of Systems Containing Flexible-Chain Polymers [M]. Elsevier, 1999
  \item Flory, P. J. Principles of Polymer Chemistry [M]. Cornell University Press, 1953
  \item Tompa, H. Polymer Solutions [M].Butterworths Publications, 1956
\end{itemize}

最后，我列出几条一般的学习建议，希望能够解决学习过程中常见的困惑。
\begin{itemize}
  \item 区分系统与环境。在讨论过程中要注意明确讨论对象。在有些问题当中我们不止讨论一个系统，或者会变换所讨论的系统（比如相平衡问题）。在这种情况下就更要敏感和清醒，每句陈述是视什么为系统，视什么为环境。然后进一步认清系统与环境之间的关系，即：有无物质交换和能量（包括功和热）交换。所谓的“开放”、“封闭”、“孤立”、“绝热”、“等温”、“等容”、“等压”……等限定词，都是在讲系统在一个变化过程中与环境的关系问题。
  \item 认真理解各类“过程”（可逆、不可逆、准静态、自发……）。任何时候都能立刻回答：当前式子用到热力学第二律了没有？用到第二定律的式子，为什么写成等式？什么时候关心变化量$\Delta M$，什么时候关心微分$\mathrm{d}M$？它们之间有什么关系？
  \item 为物理化学课本上的微分关系式推导过程补全至高等数学课所要求的细致程度，并重视在这件事上碰到的困惑，努力寻求解答。高等数学本身比较弱的同学，不要急着开始学习热力学，而是建议先复习和加强高等数学。最终要习惯于不依赖文字，只通过数学式子，就能听懂、讲好故事。
\end{itemize}

\section{热力学是怎么应用的}\footnote{这一节不是完整的热力学介绍，而是重新强调我认为值得强调的理论脉络。它假定读者已经学过一次基本的热力学，所以未必每个术语都会去介绍和定义。请读者一边复习相关课本一边阅读此节。}\label{I.2 pratical_thermodynamics}
\subsection{状态函数的微积分}
热力学理论认为，一个物体在没有外界影响的条件下必将趋近于一个称为\emph{平衡态（equilibrium state）}的状态。平衡态是这样一种状态：在没有外界影响的条件之下，物体的各部分在长时间内不发生任何变化。这里的“任何”一词意味着，系统所有能观察到的性质都不随时间改变。

热力学理论进一步认为，两个物体之间能通过接触而相互影响，由它们原本各已处于的不同的平衡态，达到它们共同的新的平衡态。普遍来说，不管有多少个物体互相接触互相影响，只要时间够长，又没有外界影响，它们最后必定达到一个共同的平衡态。

以上论断，都是大量经验的总结，但在热力学理论的体系中要当作公设。

我们常把互相接触的若干个物体中的某一个作为关心的对象，称作\emph{系统（system）}。而与系统接触的其他物体（它们在接触前已经达到各自的平衡态），在与这个系统接触达到新的平衡态之后，称作\emph{环境（environment）}。系统与环境是一对概念。我们常通过使环境的规模比系统大得多，视环境在与系统接触前后的性质变化不大，而近似地把环境当作是恒定的。比如，环境是一个温度为$T$的“大热源”，系统与这个大热源接触并发生热传导，二者的温度应该都变化到一个新的温度$T^\prime$。但所谓“大热源”意味着它的温度变化非常小，故$T^\prime\approx T$。依此类推，我们在实验上总是能够通过构建适当的环境并设计系统与环境的接触方式，来控制或改变一个系统所处于的平衡态。

按照这样的思路进行大量实验，我们终究能够发现，一个系统的平衡态能够由少数必要的参数所确定。我们称这些参数为\emph{状态变量（state variables）}。可以用来确定一个系统的平衡态的状态变量有很多，但是通过大量实验总能发现，其中只有少数几个之间是相互独立的。所谓两个状态变量相互独立，是指我们能够保持系统的其中一个状态变量恒定，独立改变系统的另一个状态变量。反之，如果我们改变一个系统的两个状态变量，它的第三个状态变量就要随之改变，无法恒定，那这第三个状态变量就不独立于前两个。

系统的状态及其变化规律是由实验总结的，我们最初认识和描述一个系统所依赖的状态变量，就都是一些可直接测量的量。通过实验，我们可以找出这些可测量的状态变量之间的依赖关系——即\emph{状态方程（equation of state）}——从而知道这些状态变量中相互独立的是哪些。状态方程是描述一个系统凡是处于任一平衡态时，各状态变量之间总满足的函数关系。例如，理想气体状态方程是
\[pV=nRT\]
这个状态方程的意思是，尽管按照平衡态的定义，一个理想气体系统在其任一平衡态下，其各部分的温度$T$、压强$p$和摩尔体积$V/n$均不随时间变化，但是它们的取值之间还受上列等式约他束。因此，这三个状态变量中只有两个是相互独立的。

状态变量分为广度性质和强度性质。我们倾向于把状态方程写成仅含强度性质的形式，以彰显物质的规律性不依赖物体的大小和规模。例如，1升水和1毫升水，在比较广的范围内，热力学性质应该相同。按照这种喜好，再以理想气体状态方程为例，它将被写成
\[pV_\text{m}=RT\]
其中$V_\text{m}\equiv V/n$是摩尔体积。

不同的物体的状态方程是不同的，这是物质的特殊性的体现。而热力学的理论基础是若干条对\emph{所有}系统均普适的基本定律。由这些热力学基本定律首先形成了内能和熵的概念，并由此衍生出焓、亥姆霍兹自由能、吉布斯自由能等函数。其中内能和熵是一个系统最基本的热力学函数。它们是系统的平衡态性质，而且都是广度性质，因此它们可以写成关于确定系统平衡态的若干个独立状态变量的函数。焓、亥姆霍兹自由能和吉布斯自由能都是用内能和熵再定义出来的函数，因此它们也是系统的平衡态性质，而且也都是广度性质，因此它们也都可以写成关于确定系统平衡态的几个独立状态变量的函数。这些由热力学基本定律衍生出来的状态函数都难以直接测量，也难以讨论其绝对取值，只能讨论它们在系统从一个状态变为另一个状态时的变化量。

讨论至此，我们谈到了两类函数。一类是在一个系统自己的状态方程的约束下，一个状态变量可以表示成其他状态变量的函数。状态变量一般是我们认识一个系统的状态方程里直接测量的一些物理量，例如对于气体，就是体积、压强或温度。它们未必都是广度性质。而另一类则是由热力学基本定律衍生出来的函数，包括内能、熵、焓和各种自由能等。它们都是广度性质。他们原则上也是关于系统在一定状态下的性质，但它们之间的约束关系需要从热力学基本定律出发去探讨，故将普适于所有系统；而不像状态变量之间的约束关系（即状态方程）那样，是系统特殊性的体现。

我们把上述的后一类函数称为\emph{热力学势（thermodynamic potential）}。它们虽然是抽象的（如前所述，又“难以直接测量”又“难以讨论其绝对值”），但却是很重要的，因为根据热力学基本定律，它们决定了任何一个物体：1）是否可能发生一个过程；2）能否稳定处于某一个状态；3）一个过程中是否吸、放热……等与实际应用直接相关的最重要的若干基本预测。而且，虽然它们本身难以直接测量，但我们将会看到，通过微分关系，它们可以由可以测量的物理量所表示出来，等于说可以被间接测量，并非完全不可知。因此热力学理论才能够应用于实际问题。

当我们说，一个系统在平衡态下，它的所有可观察的性质不随时间变化，且具体由一组状态变量确定；同时又说，一个系统能够通过与特定的环境接触，从一个平衡态变化到另一个平衡态，那就相当于说，一个系统处于任一平衡态时，它的所有可观察的性质不依赖它达到当前状态的历史路径（因为它只依赖当前状态变量）。任何系统只要处于某平衡态，无论是它的状态变量，还是它的热力学势函数，在热力学基本定律和状态方程的联合约束下，总是同一组相互独立的状态变量的函数，称为系统的\emph{状态函数（state function）}。例如，对于气体，压强由其状态方程可写成关于$\left(V,T\right)$的状态函数$p=p\left(V,T\right)$，其熵亦可写成关于$\left(V,T\right)$的状态函数$S=S\left(V,T\right)$。作为一般讨论，本讲义把一个系统的某个状态函数写成$M=M\left(X,Y,\cdots\right)$，并假定$M$是广度性质，$X$、$Y$、……等是除摩尔数$n$之外的一组互相独立的状态变量\footnote{按惯例，广度性质$M$的自变量中不把摩尔数$n$明确写出来了，因为按照广度性质的定义，$M$关于$n$的函数关系都是正比例关系，而没有其他复杂表达式的可能性。}。

物体在两个状态之间变化所做的功和所吸的热是依赖路径的，所以功和热一般不是一个系统的状态函数。然而热力学第一定律说，就算功和热依赖过程的路径，但它们的总变化（即变化量的总和\footnote{热和功是同量纲的物理量，这件事是由焦尔的热功当量实验确立的。所以可以拿它们来求总和。}）却总是一个状态函数（对于孤立系统这个状态函数就是内能）。而热力学第二定律，除了能分辨事物的发展路径是“自发”还是“不可能”的方向性外，也同时暗示了\footnote{通过规定熵是状态函数，或说通过公理化地宣称这样的状态函数的存在。}只要物体在其路径上的变化“无限慢”（可称准静态过程，又可称可逆过程），路径的不同所造成的差异就收敛了，两状态之间的功和热各自也只依赖这两个状态，而不再依赖到达的路径。所以只要我们限于讨论可逆过程，功和热各自也成了状态函数。准静态过程或可逆过程是实际过程的理想极限，它是不可能实施的，但是热力学理论基于它来探讨，好处或效果是所得到的结论是一个“保底”结论，可以知道宇宙事物发展变化规律的“底线”至少是怎样的。

只有状态函数，其变化量才可作为狭义的函数来处理，使热力学的思想能用普通化类专业大一学过的微积分精确地陈述\footnote{依赖路径而不同的变化量，其实不是狭义的函数，而是泛函。}。热力学理论在状态函数作为数学上的函数性质上，还有一些默认的附加规定。物理上，热力学认为物体总能从一个状态\emph{连续地}变化至另一个状态，也就是说状态变量的取值范围是\emph{连通的}区域。换句话说，不可能有一个状态是系统从另一个状态无论如何都变不到的。而且，任何一条变化路径，都能通过“准静态化”收敛为一条可逆的路径；这件事总能实现，从而任意两个状态间总能找到至少一条可逆过程以供讨论。有时我们甚至无需具体指出它是哪条，反正必有一条即可。无论实际吸放热或做功几何，它们的\emph{可逆}吸放热和\emph{可逆}功总可独立地视为状态函数。这在数学上相当于规定状态函数作为一个函数$M\left(X,Y,\cdots\right)$总是\emph{连续可微}的。也就是说，它们不仅可微分（可求导数），而且导函数也都连续。这件事的一个重要推论就是，其二阶交叉偏导数可交换求导顺序，即
\[\frac{\partial^2 M}{\partial X\partial Y}=\frac{\partial ^2 M}{\partial Y\partial X}\]

我们特别要注意明确一个状态函数的\emph{独立}、\emph{完整}的一组自变量。独立、完整确定系统状态的变量，可以不止一组。例如，说一个系统的状态可独立、完整地由温度$T$和压强$p$确定，它也可以独立、完整地由温度$T$和体积$V$确定，因为这个系统的压强、温度和体积由其状态方程所联系，这三个量就不是互相独立的；确定了两个就同时确定了第三个。比如确定了$\left(T,p\right)$就同时确定了$V$，即$V=V\left(T,p\right)$是系统状态方程的一种表达形式。若说$M=M\left(T,V\right)$，则理论上总能通过把$V=V\left(T,p\right)$代进去，写出$M=M\left(T,V\left(T,p\right)\right)=M\left(T,p\right)$的形式。但若说$M=M\left(T\right)$，那就叫“不完整”；若说$M=M\left(T,p,V\right)$，那就叫“不独立”。

经验表明，一个多组份系统（即混合物系统）的状态变量，除在相同前提下的单组份系统所需要的那些外，还需要增加各组份的摩尔数$n_1,n_2,\cdots$，简记为$\left\{n_i\right\}$。例如，一个不受外场（重力、电、磁等）作用，且接触力作用只有各向同性静压（即所谓的“只做体积功”）的单组分系统，摩尔数$n$一定时，它的状态可用温度$T$、压强$p$、体积$V$三个变量中的两个所确定。而对于总摩尔数$n\equiv\sum_in_i$一定的多组分系统，则还要在单组份情况的基础上加上$\left\{n_i\right\}$才能确定其状态。如果我们把一个状态函数$M\left(T,p,\left\{n_i\right\}\right)$换成相应的强度性质——即除以总摩尔数$n$得一其摩尔量$M_\text{m}\equiv M/n$，那么这个摩尔量就会是$M_\text{m}\left(T,p,\left\{x_i\right\}\right)$，其中$x_i\equiv n_i/n$是组份$i$的摩尔分数，是强度性质。这样混合物系统的性质就仍可表示为强度性质之间的关系。

只要$\left(X,Y,\cdots\right)$是一个系统的一组独立完整的状变量，则任一状态函数关于这组自变量的全微分可写成
\[\mathrm{d}M\left(X,Y,\cdots\right)=\left.\frac{\partial M}{\partial X}\right|_{Y,\cdots}\mathrm{d}X+\left.\frac{\partial M}{\partial Y}\right|_{X,\cdots}\mathrm{d}Y+\cdots\]
任意两个状态$\left(X^\circ,Y^\circ,\cdots\right)$和$\left(X,Y,\cdots\right)$之间的变化量
\begin{equation}\label{eq:I.1_integral_of_function}
  \begin{aligned}
    \Delta M & =M\left(X,Y,\cdots\right)-M\left(X^\circ,Y^\circ,\cdots\right)                                                                                                                \\
             & =\int_{X^\circ}^{X}\left.\frac{\partial M}{\partial X}\right|_{Y,\cdots}\mathrm{d}X+\int_{Y^\circ}^{Y}\left.\frac{\partial M}{\partial Y}\right|_{X,\cdots}\mathrm{d}Y+\cdots
  \end{aligned}
\end{equation}
因此，热力学理论的数学推导有两个关键，第一是状态函数的完整微分式$\mathrm{d}M$的表达式，第二就是恰当选择一个参考态$\left(X^\circ,Y^\circ,\cdots\right)$，利用上列的积分式表出任意状态$\left(X,Y,\cdots\right)$下的状态函数的明显表达式。这样的参考态在热力学资料中常被称为各种\emph{“标准态”（standard states）}，是为了方便不同的实际问题的解而灵活地选定的。

我们常常关注$M$作为热力学势时的微分式$\mathrm{d}M$或变化量$\Delta M$。因为，只要所选用的热力学势$M$，与实验方便控制的一组完整独立状态变量$\left(X,Y,\cdots\right)$，一齐形成的是系统的特性函数（将在下节正式定义），那么其变化量$\Delta M$将表明系统在两状态间变化的可能性和方向性，其微分式$\mathrm{d}M$将给出系统在某状态下的稳定性，最终发挥出热力学理论的实践应用中的威力。剩下的问题就是如何把不可直接测量的热力学势用可直接测量的状态变量表示出来——而这是可以实现的。

以下各节，将把本节的文字说法变为的数学现实。

\subsection{热力学基本关系}
热力学基本关系是仅凭热力学基本定律和状态函数的微分性质就能得出的\emph{普适}关系。不同物质之间的具体性质差异，则是由系统的状态方程来负责的。从热力学基本定律出发的推导过程，无论推出来什么东西，只要过程中没有代入具体的状态方程（包括理想气体状态方程），那么就仍是对所有系统都普适的热力学关系（前提当然是数学推算过程没有出错），它有没有用则另说。本节我们就是来看一下，坚持不代入任何状态方程，仅从热力学基本定律出发，能够推出哪些比较实用的热力学基本关系。

一个系统最基本的状态函数性质就是内能$U$和熵$S$。它们的引入与热力学第一和第二定律直接相关，详见其他热力学教材，此略。对于单组份系统，由热力学第一定律
\[\mathrm{d}U=\dbar Q+\dbar W\]
和第二定律
\[\mathrm{d} S=\frac{\dbar Q_\text{rev}}{T}\]
可以给出内能在\emph{可逆}过程中的微分式
\[\mathrm{d}U=T\mathrm{d}S+\dbar W_\text{rev}\]
在只做体积功的情况下，$\dbar W_\text{rev}=-p\mathrm{d}V$，得到
\[\mathrm{d}U=T\mathrm{d}S-p\mathrm{d}V\]
由于内能$U$是状态量，上列式子又是普适定律，故上列式子可视为$U$的完整全微分，即$\left(S,V\right)$独立、完整地确定这种系统的状态，具体有
\begin{align*}
  \mathrm{d}U                                                   & =\left.\frac{\partial U}{\partial S}\right|_V\mathrm{d}S+\left.\frac{\partial U}{\partial V}\right|_{S}\mathrm{d}V \\
                                                                & =T\mathrm{d}S-p\mathrm{d}V                                                                                         \\
  \Leftrightarrow\left.\frac{\partial U}{\partial S}\right|_{V} & =T,\quad\left.\frac{\partial U}{\partial V}\right|_{S}=-p
\end{align*}

对于多组份系统，确定系统状态的变量还包括$\left\{n_i\right\}$，即$U=U\left(S,V,\left\{n_i\right\}\right)$，故
\begin{equation}\label{eq:I.1_first_law_multicomp}
  \mathrm{d}U=\left.\frac{\partial U}{\partial S}\right|_{V,\left\{n_i\right\}}\mathrm{d}S+\left.\frac{\partial U}{\partial V}\right|_{S,\left\{n_i\right\}}\mathrm{d}V+\sum_i\left.\frac{\partial U}{\partial n_i}\right|_{S,V,\left\{n_{j\neq i}\right\}}\mathrm{d}n_i
\end{equation}
若保持该系统组成恒定，又可视系统相当于一个不区分组份种类的单组份系统，故仍有
\[\left.\frac{\partial U}{\partial S}\right|_{V,\left\{n_i\right\}}=T,\quad\left.\frac{\partial U}{\partial V}\right|_{S,\left\{n_i\right\}}=-p\]
而新引入的偏导数$\left(\partial U/\partial n_i\right)_{S,V,\left\{n_{j\neq i}\right\}}$则定义为组份$i$在混合物中的\emph{化学势（chemical potential）}，记为
\[\mu_i\eqdef\left.\frac{\partial U}{\partial n_i}\right|_{S,V,\left\{n_{j\neq i}\right\}},\]

对焓、亥姆霍兹自由能和吉布斯自由能的定义式（仍假定系统只做体积功）
\[H\eqdef U+pV,\quad A\eqdef U-TS,\quad G\eqdef U+pV-TS\]
作微分，可得出这些热力学函数作为\emph{特性函数（characteristic functions）}\footnote{见《物理化学》\S 3.13。}的微分式\footnote{在处理开放系统时，还会用到巨热力学势$J\eqdef U-TS-n\mu$，这里不介绍了。}
\begin{align}
  \mathrm{d}H & = T\mathrm{d}S+V\mathrm{d}p+\sum_i\mu_i\mathrm{d}n_i\label{eq:I.1_dH} \\
  \mathrm{d}A & =-S\mathrm{d}T-p\mathrm{d}V+\sum_i\mu_i\mathrm{d}n_i\label{eq:I.1_dA} \\
  \mathrm{d}G & =-S\mathrm{d}T+V\mathrm{d}p+\sum_i\mu_i\mathrm{d}n_i\label{eq:I.1_dG}
\end{align}
例如，对吉布斯自由能定义式作全微分，就有
\[\mathrm{d}G=\mathrm{d}U+p\mathrm{d}V+V\mathrm{d}p-T\mathrm{d}S-S\mathrm{d}T\]
把式\eqref{eq:I.1_first_law_multicomp}代入上式就能得到式\eqref{eq:I.1_dG}。

式\eqref{eq:I.1_dH}至\eqref{eq:I.1_dG}与它们的全微分式比较可得
\begin{equation}
  \mu_i=\left.\frac{\partial U}{\partial n_i}\right|_{S,V,\left\{n_{j\neq i}\right\}}
  =\left.\frac{\partial H}{\partial n_i}\right|_{S,p,\left\{n_{j\neq i}\right\}}
  =\left.\frac{\partial A}{\partial n_i}\right|_{T,V,\left\{n_{j\neq i}\right\}}
  =\left.\frac{\partial G}{\partial n_i}\right|_{T,p,\left\{n_{j\neq i}\right\}}\label{eq:I.1_first_order_partial_mu}
\end{equation}
以及
\begin{align}
  T & =\left.\frac{\partial U}{\partial S}\right|_{V,\left\{n_i\right\}}=\left.\frac{\partial H}{\partial S}\right|_{V,\left\{n_i\right\}},\label{eq:I.1_first_order_partial_T}   \\
  p & =-\left.\frac{\partial U}{\partial V}\right|_{S,\left\{n_i\right\}}=-\left.\frac{\partial A}{\partial V}\right|_{T,\left\{n_i\right\}},\label{eq:I.1_first_order_partial_p} \\
  V & =\left.\frac{\partial H}{\partial p}\right|_{S,\left\{n_i\right\}}=\left.\frac{\partial G}{\partial p}\right|_{T,\left\{n_i\right\}},\label{eq:I.1_first_order_partial_V}   \\
  S & =-\left.\frac{\partial A}{\partial T}\right|_{V,\left\{n_i\right\}}=-\left.\frac{\partial G}{\partial T}\right|_{p,\left\{n_i\right\}}\label{eq:I.1_first_order_partial_S}
\end{align}

\subsection{响应函数}
$U$、$S$、$H$、$A$、$G$等热力学函数（及其偏导数）是无法直接测量的。我们能直接测量的是系统的状态方程出现的那些状态变量。此外我们还能通过量热实验测量系统的热容。因此，我们需要把热力学函数的微分式中的那些偏导数努力地表示成仅含这些可测量的表达形式，才有望得到实用化。以下介绍的是，物质的量恒定（封闭系统），只做体积功的单组份均相系统的可测量量的定义。它们又称为\emph{响应函数（response functions）}，见表\ref{tab:response_functions}。

\begin{longtable}{m{0.25\textwidth}m{0.5\textwidth}}
  \caption{各种响应函数的定义及普适关系}\label{tab:response_functions}                                                                                                                                                                                                                                                                    \\
  \hline
  \multicolumn{2}{l}{{热响应函数：}}                                                                                                                                                                                                                                                                                              \\[-4ex]
  定容热容\footnote{定义式中的$Q_\text{rev}$是可逆等容变温过程。} & \begin{align}\label{eq:I.1_heat_capacity_entropy_V}C_V\eqdef\frac{\dbar Q_\text{rev}}{\mathrm{d}T}=\left.\frac{\partial U}{\partial T}\right|_{V,\left\{n_i\right\}}=T\left.\frac{\partial S}{\partial T}\right|_{V,\left\{n_i\right\}}\end{align} \\[-4ex]
  定压热容\footnote{定义式中的$Q_\text{rev}$是可逆等压变温过程。} & \begin{align}\label{eq:I.1_heat_capacity_entropy_p}C_p\eqdef\frac{\dbar Q_\text{rev}}{\mathrm{d}T}=\left.\frac{\partial H}{\partial T}\right|_{p,\left\{n_i\right\}}=T\left.\frac{\partial S}{\partial T}\right|_{p,\left\{n_i\right\}}\end{align} \\[-4ex]
  热容比                                          & \begin{align}\gamma\eqdef C_p/C_V\end{align}                                                                                                                                                                                                                               \\
  \multicolumn{2}{l}{{$pVTn_i$响应函数:}}                                                                                                                                                                                                                                                                                       \\[-4ex]
  等压膨胀系数                                       & \begin{align}\alpha_p\eqdef V^{-1}\left.\frac{\partial V}{\partial T}\right|_{p,\left\{n_i\right\}}\end{align}                                                                                                                                                             \\[-4ex]
  等温压缩系数                                       & \begin{align}\kappa_T\eqdef-V^{-1}\left.\frac{\partial V}{\partial p}\right|_{T,\left\{n_i\right\}}\end{align}                                                                                                                                                             \\[-4ex]
  等容压强系数                                       & \begin{align}\beta_V\eqdef\left.\frac{\partial p}{\partial T}\right|_{V,\left\{n_i\right\}}\end{align}                                                                                                                                                                     \\
  \multicolumn{2}{l}{{等熵响应函数：}}                                                                                                                                                                                                                                                                                             \\[-4ex]
  等熵热膨胀系数                                      & \begin{align}\alpha_S\eqdef V^{-1}\left.\frac{\partial V}{\partial T}\right|_{S,\left\{n_i\right\}}\end{align}                                                                                                                                                             \\[-4ex]
  等熵压缩系数                                       & \begin{align}\kappa_S\eqdef -V^{-1}\left.\frac{\partial V}{\partial p}\right|_{S,\left\{n_i\right\}}\end{align}                                                                                                                                                            \\[-4ex]
  等熵压强系数                                       & \begin{align}\beta_S\eqdef\left.\frac{\partial p}{\partial T}\right|_{S,\left\{n_i\right\}}\end{align}                                                                                                                                                                     \\
  \multicolumn{2}{l}{{普适关系式：}}                                                                                                                                                                                                                                                                                              \\
                                               & \begin{align}\alpha_p=\beta_V\kappa_T\end{align}                                                                                                                                                                                                                           \\ [-10ex]
                                               & \begin{align}\gamma=\kappa_T/\kappa_S\end{align}                                                                                                                                                                                                                           \\[-10ex]
                                               & \begin{align}C_p-C_V=TV\alpha_p^2/\kappa_T\end{align}                                                                                                                                                                                                                      \\ [-4ex]

  \hline
\end{longtable}

多组份系统的各组份物质的量$\left\{n_i\right\}$也是状态变量，所以多组份系统的状态变量之间的偏导数还应包括：
\[\left.\frac{\partial p}{\partial n_i}\right|_{T,V,\left\{n_{j\neq i}\right\}},\quad\left.\frac{\partial V}{\partial n_i}\right|_{T,p,\left\{n_{j\neq i}\right\}},\quad\left.\frac{\partial T}{\partial n_i}\right|_{p,V,\left\{n_{j\neq i}\right\}}\]
其中第二个就是偏摩尔体积\footnote{偏摩尔量将在本讲义\S\ref{sec:II.2 partial_molar_quantities}中再作详细讨论。}。实际上以上三个只需要测量其中的偏摩尔体积即可。因为
\begin{align*}
  \left.\frac{\partial p}{\partial n_i}\right|_{T,V,\left\{n_{j\neq i}\right\}} & =\left.\frac{\partial p}{\partial V}\right|_{T,\left\{n_i\right\}}\left.\frac{\partial V}{\partial n_i}\right|_{T,p,\left\{n_{j\neq i}\right\}}=-\frac{1}{\kappa_TV}\left.\frac{\partial V}{\partial n_i}\right|_{T,p,\left\{n_{j\neq i}\right\}}, \\
  \left.\frac{\partial T}{\partial n_i}\right|_{p,V,\left\{n_{j\neq i}\right\}} & =\left.\frac{\partial T}{\partial V}\right|_{p,\left\{n_i\right\}}\left.\frac{\partial V}{\partial n_i}\right|_{T,p,\left\{n_{j\neq i}\right\}}=\frac{1}{\alpha_p V}\left.\frac{\partial V}{\partial n_i}\right|_{T,p,\left\{n_{j\neq i}\right\}}
\end{align*}

类似地，$p$、$V$关于$n_i$的等温偏导数也有另一套对应的等熵的版本，不再列出了。

\subsection{Maxwell关系和Tobolsky方法}
运用Tobolsky方法\cite{Tobolsky1942}，可以把任意热力学函数偏导数表示成仅含上列可测量的形式，从而打通热力学理论和实验应用的道路。这个方法需要使用Maxwell关系\footnote{参见《物理化学》\S 3.13。}。

\subsubsection{Maxwell关系}
具体地，对式\eqref{eq:I.1_first_order_partial_mu}至式\eqref{eq:I.1_first_order_partial_S}中的偏导数再作不同变量的交叉二阶导数，并由于这些状态函数都假定连续可微而可交换偏导数顺序，可以得到一系列Maxwell关系式（表\ref{tab:Maxwell_relations}），其中将会出现很多$pVTn_i$响应函数。

\begin{longtable}{m{0.9\textwidth}}
  \caption{Maxwell关系}\label{tab:Maxwell_relations}                                                                                                                                                                                                                                                 \\
  \hline
  由内能的交叉偏导数得到：                                                                                                                                                                                                                                                                                     \\[-4ex]
  \begin{align}
    \left.\frac{\partial^2 U}{\partial S\partial V}\right|_{\left\{n_i\right\}}              =\left.\frac{\partial T}{\partial V}\right|_{S,\left\{n_i\right\}}=\left(\alpha_S V\right)^{-1}=-\left.\frac{\partial p}{\partial S}\right|_{V,\left\{n_i\right\}}\label{eq:I.1_Maxwell_USV}\end{align} \\ [-8ex]
  \begin{align}\left.\frac{\partial ^2U}{\partial n_i\partial S}\right|_{V,\left\{n_{j\neq i}\right\}}  =\left.\frac{\partial \mu_i}{\partial S}\right|_{V,\left\{n_i\right\}}=\left.\frac{\partial T}{\partial n_i}\right|_{S,V,\left\{n_{j\neq i}\right\}}\label{eq:I.1_Maxwell_UnS}\end{align}  \\[-8ex]
  \begin{align}\left.\frac{\partial ^2U}{\partial n_i\partial V}\right|_{S,\left\{n_{j\neq i}\right\}}  =\left.\frac{\partial \mu_i}{\partial V}\right|_{S,\left\{n_i\right\}}=-\left.\frac{\partial p}{\partial n_i}\right|_{S,V,\left\{n_{j\neq i}\right\}}\label{eq:I.1_Maxwell_UnV}\end{align} \\
  由焓的交叉偏导数得到                                                                                                                                                                                                                                                                                       \\ [-4ex]
  \begin{align}
    \left.\frac{\partial^2 H}{\partial S\partial p}\right|_{\left\{n_i\right\}}              =\left.\frac{\partial T}{\partial p}\right|_{S,\left\{n_i\right\}}=\beta_S^{-1}=\left.\frac{\partial V}{\partial S}\right|_{p,\left\{n_i\right\}}\label{eq:I.1_Maxwell_HSp}\end{align}                  \\[-8ex]
  \begin{align}\left.\frac{\partial ^2H}{\partial n_i\partial S}\right|_{p,\left\{n_{j\neq i}\right\}}  =\left.\frac{\partial \mu_i}{\partial S}\right|_{p,\left\{n_i\right\}}=\left.\frac{\partial T}{\partial n_i}\right|_{S,p,\left\{n_{j\neq i}\right\}}\label{eq:I.1_Maxwell_HnS}\end{align}  \\[-8ex]
  \begin{align}\left.\frac{\partial ^2H}{\partial n_i\partial p}\right|_{S,\left\{n_{j\neq i}\right\}}  =\left.\frac{\partial \mu_i}{\partial p}\right|_{S,\left\{n_i\right\}}=\left.\frac{\partial V}{\partial n_i}\right|_{S,p,\left\{n_{j\neq i}\right\}}\label{eq:I.1_Maxwell_Hnp}\end{align}  \\
  由亥姆霍兹自由能的交叉偏导数得到：                                                                                                                                                                                                                                                                                \\ [-4ex]
  \begin{align}
    \left.\frac{\partial^2 A}{\partial T\partial V}\right|_{\left\{n_i\right\}}              =\left.\frac{\partial S}{\partial V}\right|_{T,\left\{n_i\right\}}=\left.\frac{\partial p}{\partial T}\right|_{V,\left\{n_i\right\}}=\beta_V\label{eq:I.1_Maxwell_ATV}\end{align}                       \\[-8ex]
  \begin{align}\left.\frac{\partial ^2A}{\partial n_i\partial T}\right|_{V,\left\{n_{j\neq i}\right\}}  =\left.\frac{\partial \mu_i}{\partial T}\right|_{V,\left\{n_i\right\}}=-\left.\frac{\partial S}{\partial n_i}\right|_{T,V,\left\{n_{j\neq i}\right\}}\label{eq:I.1_Maxwell_AnT}\end{align} \\[-8ex]
  \begin{align}\left.\frac{\partial ^2A}{\partial n_i\partial V}\right|_{T,\left\{n_{j\neq i}\right\}}  =\left.\frac{\partial \mu_i}{\partial V}\right|_{T,\left\{n_i\right\}}=-\left.\frac{\partial p}{\partial n_i}\right|_{T,V,\left\{n_{j\neq i}\right\}}\label{eq:I.1_Maxwell_AnV}\end{align} \\
  由吉布斯自由能的交叉偏导数得到：                                                                                                                                                                                                                                                                                 \\ [-4ex]
  \begin{align}
    \left.\frac{\partial^2 G}{\partial T\partial p}\right|_{\left\{n_i\right\}}              =\left.\frac{\partial S}{\partial p}\right|_{T,\left\{n_i\right\}}=-\left.\frac{\partial V}{\partial T}\right|_{p,\left\{n_i\right\}}=-\alpha_p V\label{eq:I.1_Maxwell_GTp}\end{align}                  \\[-8ex]
  \begin{align}\left.\frac{\partial ^2G}{\partial n_i\partial T}\right|_{p,\left\{n_{j\neq i}\right\}}  =\left.\frac{\partial \mu_i}{\partial T}\right|_{p,\left\{n_i\right\}}=-\left.\frac{\partial S}{\partial n_i}\right|_{T,p,\left\{n_{j\neq i}\right\}}\label{eq:I.1_Maxwell_GnT}\end{align} \\[-8ex]
  \begin{align}\left.\frac{\partial ^2G}{\partial n_i\partial p}\right|_{T,\left\{n_{j\neq i}\right\}}  =\left.\frac{\partial \mu_i}{\partial p}\right|_{T,\left\{n_i\right\}}=\left.\frac{\partial V}{\partial n_i}\right|_{T,p,\left\{n_{j\neq i}\right\}}\label{eq:I.1_Maxwell_GnV}\end{align}  \\
  \hline
\end{longtable}
最后，从上述Maxwell关系可归纳出，除了$C_p$、$C_V$、各$pVTn_i$（等温或等熵）响应函数，还有两种必须知道的量我们还没讨论，那就是等压或等容偏摩尔熵（式\eqref{eq:I.1_Maxwell_AnT}和\eqref{eq:I.1_Maxwell_GnT}）。具体地，它们分别是含在视熵为$\left(T,V,\left\{n_i\right\}\right)$或$\left(T,p,\left\{n_i\right\}\right)$的函数的全微分中的：
\begin{equation}
  \begin{aligned}
    \mathrm{d}S & =\left.\frac{\partial S}{\partial T}\right|_{V,\left\{n_i\right\}}\mathrm{d}T+\left.\frac{\partial S}{\partial V}\right|_{T,\left\{n_i\right\}}\mathrm{d}V+\sum_i\left.\frac{\partial S}{\partial n_i}\right|_{T,V,\left\{n_{j\neq i}\right\}}\mathrm{d}n_i \\
                & =\frac{C_V}{T}\mathrm{d}T+\beta_V\mathrm{d}V+\sum_i\left.\frac{\partial S}{\partial n_i}\right|_{T,V,\left\{n_{j\neq i}\right\}}\mathrm{d}n_i \label{eq:I.1_dS_T_V}
  \end{aligned}
\end{equation}
\begin{equation}
  \begin{aligned}
    \mathrm{d}S & =\left.\frac{\partial S}{\partial T}\right|_{p,\left\{n_i\right\}}\mathrm{d}T+\left.\frac{\partial S}{\partial p}\right|_{T,\left\{n_i\right\}}\mathrm{d}p+\sum_i\left.\frac{\partial S}{\partial n_i}\right|_{T,p,\left\{n_{j\neq i}\right\}}\mathrm{d}n_i \\
                & =\frac{C_p}{T}\mathrm{d}T-\alpha_pV\mathrm{d}p+\sum_i\left.\frac{\partial S}{\partial n_i}\right|_{T,p,\left\{n_{j\neq i}\right\}}\mathrm{d}n_i\label{eq:I.1_dS_T_p}
  \end{aligned}
\end{equation}
其中用到了式\eqref{eq:I.1_heat_capacity_entropy_p}和\eqref{eq:I.1_heat_capacity_entropy_V}。这些偏摩尔熵的实验测量，跟熵本身一样，最终是落实到相应的偏摩尔热容
\begin{align}
  C_{p,i} & \eqdef\left.\frac{\partial C_p}{\partial n_i}\right|_{T,p\left\{n_{j\neq i}\right\}} \label{eq:I.1_def_Cpi} \\
  C_{V,i} & \eqdef\left.\frac{\partial C_V}{\partial n_i}\right|_{T,V\left\{n_{j\neq i}\right\}}\label{eq:I.1_def_CVi}
\end{align}
和偏摩尔$pVT$等温响应函数
\begin{align}
  \alpha_{p,i} & \eqdef V^{-1}\left.\frac{\partial \alpha_p}{\partial n_i}\right|_{T,p,\left\{n_{j\neq i}\right\}}\label{eq:I.1_def_partial_molar_expansion_coeff} \\
  \kappa_{T,i} & \eqdef V^{-1}\left.\frac{\partial \kappa_T}{\partial n_i}\right|_{T,p,\left\{n_{j\neq i}\right\}}\label{eq:I.1_def_partial_molar_compressibility}
\end{align}
的测量上。注意，式\eqref{eq:I.1_def_partial_molar_expansion_coeff}和\eqref{eq:I.1_def_partial_molar_compressibility}的定义式使得$\alpha_{p,i}\neq\left(\partial\alpha_p/\partial n_i\right)_{T,p,\left\{n_{j\neq i}\right\}}$、$\kappa_{T,i}\neq\left(\partial\kappa_T/\partial n_i\right)_{T,p,\left\{n_{j\neq i}\right\}}$。这样定义是优先考虑使$\alpha_{p,i}$、$\kappa_{T,i}$与$\alpha_p$、$\kappa_T$分别都满足偏摩尔量加和性（见\S\ref{sec:II.2 partial_molar_quantities}）。

\subsubsection{Tobolsky方法}
有了这些关系，我们就总是能够利用已知系统的状态方程解析式或实验测量的$pVTn_i$数据，把式\eqref{eq:I.1_first_law_multicomp}至\eqref{eq:I.1_dG}表示成仅含可测量的形式，再由式\eqref{eq:I.1_integral_of_function}得到系统的任何平衡态热力学行为，实现“想算什么就算什么”的自由。其中一种常见的套路就是Tobolsky方法。

例如，我们随便要求算一个古怪的偏导数：$\left.\frac{\partial H}{\partial A}\right|_{S}$。从这个偏导数形式上看，它来自由$\left(A,S\right)$所独立而完整确定的形式$H=H\left(A,S\right)$，是单组分系统。故令$X\equiv\left.\frac{\partial H}{\partial F}\right|_{S}$、$Y\equiv\left.\frac{\partial H}{\partial S}\right|_{A}$，则$H$的全微分可表示成
\[\mathrm{d}H=X\mathrm{d}A+Y\mathrm{d}S\]
但是$H$自己有作为特性函数的微分式\eqref{eq:I.1_dH}（单组分系统$\mathrm{d}n_i=0$），故可联系而得到以下式子：
\[X\mathrm{d}A+Y\mathrm{d}S=T\mathrm{d}S+V\mathrm{d}p\]
然后，我们需要确定，我们的实验是在什么特性参数条件下做的。例如，我们的实验是恒温恒压下做的，那么我们就需要把上列的微分式中的$\mathrm{d}A$、$\mathrm{d}S$换成$\mathrm{d}T$和$\mathrm{d}p$。这需要恰当选用相应的式子。比如，如果我们用式\eqref{eq:I.1_dA}把$\mathrm{d}A$换掉，就会新增我们所不需要的一个$\mathrm{d}V$项。这时只需再通过状态方程按$V=V\left(T,p\right)$，可以把$\mathrm{d}V=\alpha_pV\mathrm{d}T-\kappa_TV\mathrm{d}p$再代进去，就得到只含$\mathrm{d}T$和$\mathrm{d}p$的项了。类似地$\mathrm{d}S$用式\eqref{eq:I.1_dS_T_p}代入，最终可得到：
\[\left(-SX-pX\alpha_pV+\frac{YC_p}{T}-C_p\right)\mathrm{d}T+\left(pX\kappa_TV-Y\alpha_pV+T\alpha_pV-V\right)\mathrm{d}p=0\]
由于上式是热力学关系推出来的，总成立，故有
\begin{align*}
  -SX-pX\alpha_pV+\frac{YC_p}{T}-C_p  & =0 \\
  pX\kappa_TV-Y\alpha_pV+T\alpha_pV-V & =0
\end{align*}
解得
\begin{align*}
  X & =\frac{C_p}{C_p p \kappa_T-T\alpha_p\left(S+pV\alpha_p\right)}                          \\
  Y & =T\left(1-\frac{S+p V \alpha_p}{T\alpha_p\left(S+pV\alpha_p\right)-C_pp\kappa_T}\right)
\end{align*}
其中$X$是我们想要的。我们发现，这些表达式中除了含有之前说到的各种可测量响应函数之外，还含有熵值$S$。选定一个参考态，由式\eqref{eq:I.1_dS_T_p}和式\eqref{eq:I.1_integral_of_function}，仍然能把$S=S\left(T,p\right)$的表达式以仅含可测量的形式表达出来，结果无非是使$X$或$Y$的表达式依赖参考态的选择而已。

\subsection{系统的完整热力学性质}
给定一个封闭系统，至少要测量哪些物理量，就能完整地确定它的热力学性质，以预测它在各种状态间过程的行为？

我们首先考虑单组分系统。观察热力学第一定律的微分形式\eqref{eq:I.1_first_law_multicomp}（封闭系统$\mathrm{d}n=0$）可见，想要完整确定系统内能函数形式，若视温度$T$和压强$p$属于可实验控制的参数，则还需要知道$\mathrm{d}S$和$\mathrm{d}V$两个函数微分。其中函数$V=V\left(T,p\right)$就是这个系统的$pVT$状态方程，而由熵的定义和热容的定义，想要知道熵函数至少要知道某种可逆过程热容关于系统状态的函数（例如$C_p=C_p\left(T,p\right)$）。若已经知道了内能$U$、熵$S$的全微分，以及状态方程$V\left(T,p\right)$，那么通过Tobolsky方法，其他热力学势函数的全微分，以及任意热力学函数偏导数也就都知道了。归结起来我们可以说，内能和熵是一个系统最基本的两个热力学函数。而从可测量的角度，确定一个系统完整热力学性质，至少需要知道其$pVT$状态方程，以及某一种可逆过程热容关于系统状态的函数。

对于多组分系统，式\eqref{eq:I.1_first_law_multicomp}暗示我们还需要在单组份的基础上知道每一组份的化学势$\mu_i$。这不是直接可测的量。但是到\S\ref{sec:II.2 partial_molar_quantities}节我们将会知道，偏摩尔热力学函数之间也有一般关系（见式\eqref{eq:II.2_partial_molar_thermodynamic_functions_relation}及其讨论）。因此，正如单组份系统的情况中，我们需要知道一种可逆过程热容和$pVT$状态方程那样，为了多组份系统的$\mu_i$，我们相应需要知道各组份的偏摩尔可逆过程热容和偏摩尔$pVT$关系，后者即偏摩尔体积的函数$V_i\left(T,p,\left\{n_j\right\}\right)$的形式。实际上，由\S\ref{sec:II.2 partial_molar_quantities}介绍的偏摩尔量的加和性质及实验测量原理，我们只需要测量混合物系统的相应摩尔性质随各组份的变化关系，就能得到相应的偏摩尔性质。归结起来就可以说，对于多组分系统，至少需要知道其$pVTn_i$状态方程（$V\left(T,p,\left\{n_i\right\}\right)$函数的完整表达式）和某一可逆过程热容关于系统状态的函数（关于$\left(T,p,\left\{n_i\right\}\right)$的完整依赖关系）,才足以确定一个混合物的完整热力学性质。仅知道一个混合物系统在某组成下的$pVT$状态方程和可逆热容是信息不足的。
\end{document}